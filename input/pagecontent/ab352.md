

let’s treat AB 352 as an organizational policy encoded as a top-level XACML PolicySet that:

- Denies disclosure of certain sensitive data (abortion, gender‑affirming care, contraception, etc.) to out‑of‑state recipients.
- Applies to a hospital organization in California.
- Uses attributes to represent:
  - Data category (e.g., health:sensitivity).
  - Recipient jurisdiction (e.g., recipient:jurisdiction).
  - Purpose of use (optional, but useful).
  - Action (e.g., disclose, access, use).

This XACML treats AB 352 as an organizational policy implemented by a California hospital, expressed as a top‑level PolicySet with subordinate policies for:

- Denying disclosure of AB 352‑sensitive data to out‑of‑state entities
- Allowing in‑state treatment access
- Enforcing segmentation obligations (modeled as XACML Obligations)

Everything is self‑contained and ready for use in an IG or PDP example.

~~~xml
{% include_relative xacml-ab352.xml %}
~~~

### FHIR Consent with XACML Policies

A FHIR Consent instance
- policyBasis → AB 352 statutory anchor
- policy.url → this XACML policyset
- provision.class → sensitivity categories
- provision.actor → in‑state vs. out‑of‑state recipients

### PDP Evaluation

~~~mermaid
flowchart TD

    A["Request to access/disclose data"] --> B["PEP collects attributes"]
    B --> C["Attributes: action, sensitivity, recipient jurisdiction, purpose"]
    C --> D["PDP evaluates PolicySet urn:org:hospital:policyset:AB352"]

    D --> E1{"Action = disclose?"}
    E1 -- Yes --> F1{"Sensitivity in AB352 set?"}
    F1 -- Yes --> G1{"Recipient jurisdiction != CA?"}
    G1 -- Yes --> H1["Deny<br/>Obligation: log-denial"]
    G1 -- No --> I1["Continue evaluation<br/>(local org policies)"]
    F1 -- No --> I1

    E1 -- No --> E2{"Action = access/use?"}
    E2 -- Yes --> F2{"Recipient jurisdiction = CA<br/>AND purpose = TREATMENT?"}
    F2 -- Yes --> H2["Permit<br/>Obligation: segment-sensitive-data"]
    F2 -- No --> I2["NotApplicable or other org policies"]

    E2 -- No --> I2

    H2 --> J["PEP enforces segmentation<br/>(EHR/HIE data segregation)"]
    H1 --> K["PEP denies disclosure<br/>and records AuditEvent"]

~~~

### Not just FHIR

IHE APPC / XUA mapping for AB352
XUA (SAML / OAuth token attributes)

Subject jurisdiction / location

XUA attribute: urn:oasis:names:tc:xspa:1.0:subject:locality (or a custom attribute)

Maps to XACML: urn:org:hospital:attribute:recipient:jurisdiction

Purpose of use

XUA attribute: urn:oasis:names:tc:xspa:1.0:subject:purposeofuse (e.g., TREAT)

Maps to XACML: urn:org:hospital:attribute:purpose-of-use

Role / organization

XUA attributes: role, organization identifiers

Used to distinguish in‑state vs out‑of‑state Organizations in your PDP attribute resolver.

APPC (Access Control Policy)

Policy artifact:

APPC policy references the same XACML PolicySetId: urn:org:hospital:policyset:AB352.

In your APPC metadata, you can declare:

Policy type: “regulatory‑driven organizational policy”

Policy reference: FHIR Consent instance Consent/consent-ab352-example

Enforcement points:

HIE edge / gateway: PEP uses XUA token + APPC policy reference to call PDP with the AB352 PolicySet.

EHR internal services: same XACML policy, but invoked with richer resource attributes (e.g., FHIR tags for sensitivity).

FHIR ↔ APPC ↔ XACML linkage

FHIR Consent.policy.uri → APPC policy identifier → XACML PolicySetId.

FHIR Consent.provision.class → sensitivity tags on FHIR resources (e.g., meta.security) → XACML health:sensitivity.

XUA attributes (purpose, locality, role) → XACML subject/environment attributes.

